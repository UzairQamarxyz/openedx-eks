# This patch surgically updates the volume source to a Secret
# and adds the envFrom reference without touching images.
- op: replace
  path: /spec/template/spec/volumes/0
  value:
      name: config
      secret:
          secretName: openedx-settings
          items:
              - key: lms.env.json
                path: lms.env.json
              - key: cms.env.json
                path: cms.env.json
- op: add
  path: /spec/template/spec/containers/0/envFrom
  value:
      - secretRef:
            name: openedx-settings
